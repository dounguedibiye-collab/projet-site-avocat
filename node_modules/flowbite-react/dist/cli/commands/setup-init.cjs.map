{"version":3,"file":"setup-init.cjs","sources":["../../../src/cli/commands/setup-init.ts"],"sourcesContent":["import fs from \"fs/promises\";\nimport { parseSync } from \"oxc-parser\";\nimport { initFilePath, initJsxFilePath } from \"../consts\";\nimport { compareNodes } from \"../utils/compare-nodes\";\nimport type { Config } from \"../utils/create-config\";\nimport { removeReactImport } from \"../utils/remove-react-import\";\n\n/**\n * Sets up the `.flowbite-react/init.tsx` file in the project.\n *\n * This function ensures the init.tsx file exists and is up-to-date with the current configuration.\n * It will create or update the file if needed.\n */\nexport async function setupInit(config: Config) {\n  const content = `\n/* eslint-disable */\n// @ts-nocheck\n// biome-ignore-all lint: auto-generated file\n\n// This file is auto-generated by the flowbite-react CLI.\n// Do not edit this file directly.\n// Instead, edit the .flowbite-react/config.json file.\n\nimport { StoreInit } from \"flowbite-react/store/init\";\nimport React from \"react\";\n\nexport const CONFIG = {\n  dark: ${config.dark},\n  prefix: \"${config.prefix}\",\n  version: ${config.version},\n};\n\nexport function ThemeInit() {\n  return <StoreInit {...CONFIG} />;\n}\n\nThemeInit.displayName = \"ThemeInit\";\n`.trim();\n\n  const targetPath = config.tsx ? initFilePath : initJsxFilePath;\n  const oldPath = config.tsx ? initJsxFilePath : initFilePath;\n\n  try {\n    let currentContent = \"\";\n    try {\n      currentContent = await fs.readFile(targetPath, \"utf-8\");\n    } catch {\n      console.log(`Creating ${targetPath} file...`);\n      setTimeout(() => fs.writeFile(targetPath, content), 10);\n    }\n\n    if (currentContent) {\n      const currentAst = removeReactImport(parseSync(\"init.tsx\", currentContent));\n      const newAst = removeReactImport(parseSync(\"init.tsx\", content));\n\n      if (!compareNodes(currentAst.program, newAst.program)) {\n        console.log(`Updating ${targetPath} file...`);\n        setTimeout(() => fs.writeFile(targetPath, content), 10);\n      }\n    }\n\n    try {\n      await fs.access(oldPath);\n      console.log(`Removing ${oldPath} file...`);\n      await fs.unlink(oldPath);\n    } catch {\n      // noop\n    }\n  } catch (error) {\n    console.error(`Failed to update ${targetPath}:`, error);\n  }\n}\n"],"names":["initFilePath","initJsxFilePath","removeReactImport","parseSync","compareNodes"],"mappings":";;;;;;;;AAMO,eAAe,SAAS,CAAC,MAAM,EAAE;AACxC,EAAE,MAAM,OAAO,GAAG;AAClB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC;AACtB,WAAW,EAAE,MAAM,CAAC,MAAM,CAAC;AAC3B,WAAW,EAAE,MAAM,CAAC,OAAO,CAAC;AAC5B;;AAEA;AACA;AACA;;AAEA;AACA,CAAC,CAAC,IAAI,EAAE;AACR,EAAE,MAAM,UAAU,GAAG,MAAM,CAAC,GAAG,GAAGA,mBAAY,GAAGC,sBAAe;AAChE,EAAE,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,GAAGA,sBAAe,GAAGD,mBAAY;AAC7D,EAAE,IAAI;AACN,IAAI,IAAI,cAAc,GAAG,EAAE;AAC3B,IAAI,IAAI;AACR,MAAM,cAAc,GAAG,MAAM,EAAE,CAAC,QAAQ,CAAC,UAAU,EAAE,OAAO,CAAC;AAC7D,IAAI,CAAC,CAAC,MAAM;AACZ,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC;AACnD,MAAM,UAAU,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC;AAC7D,IAAI;AACJ,IAAI,IAAI,cAAc,EAAE;AACxB,MAAM,MAAM,UAAU,GAAGE,mCAAiB,CAACC,mBAAS,CAAC,UAAU,EAAE,cAAc,CAAC,CAAC;AACjF,MAAM,MAAM,MAAM,GAAGD,mCAAiB,CAACC,mBAAS,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;AACtE,MAAM,IAAI,CAACC,yBAAY,CAAC,UAAU,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,EAAE;AAC7D,QAAQ,OAAO,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC;AACrD,QAAQ,UAAU,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC;AAC/D,MAAM;AACN,IAAI;AACJ,IAAI,IAAI;AACR,MAAM,MAAM,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC;AAC9B,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;AAChD,MAAM,MAAM,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC;AAC9B,IAAI,CAAC,CAAC,MAAM;AACZ,IAAI;AACJ,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC;AAC3D,EAAE;AACF;;;;"}